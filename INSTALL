
                    Sedna Installation Instructions

   This document describes the installation of Sedna from the source
   code distribution.
     _________________________________________________________________

                               Short Version

   In a terminal type (substitute <install-path> with the path to a directory
   for which you have read/write permissions):

SEDNA_INSTALL=<install-path>
export SEDNA_INSTALL
make
make install
   
   NOTE! Under FreeBSD you should use GNU make (by default it means "gmake" 
         command instead of "make"). 
         See also Post-Installation Setup::FreeBSD below.
   
   NOTE! The operating system user that is going to run Sedna must have 
         r-w-x permissions for the following Sedna directories:

$SEDNA_INSTALL/data
$SEDNA_INSTALL/cfg

   To grant the necessary permisions to the user under Linux, MacOS, FreeBSD 
   or Solaris you can use the following command (suppose, <sedna-user> is 
   the user that is going to run Sedna):

chown <sedna-user> cfg data
     _________________________________________________________________

                                Long Version

   The long version is the rest of this document.

     _________________________________________________________________

                                Requirements

   Sedna is expected to build and run on the following platforms:
   1. Microsoft Windows 2000 and higher
   2. Linux with kernel version 2.4 and higher
   3. Mac OS X (PPC or Intel platform)
   4. FreeBSD (see also Post-Installation Setup::FreeBSD below)
   5. Solaris (x86)

   Note: Sedna will *not* run on Microsoft Windows 95/98/ME.
   Note: Sedna can be build from sources only under 32-bit platforms.

   A modern POSIX-compatible platform should be able to run Sedna potentially, 
   but some effort should be made.

   The following software packages are required for building Sedna:

     * A Unix console and a set of widely known Unix tools such as rm, mkdir,
       m4, etc are required. They are usually present in any Unix 
       installation. For the Windows platform you need the Cygwin package.
     * GNU make is required; other make programs will *not* work. 
     * You need a C/C++ compiler. For the Windows platform Microsoft C/C++ 
       complier version 12.00.xxxx (Visual C++ 6.0) or higher is required. 
       For Linux GCC version 3.x.x or higher is required. GCC is also required 
       for the Windows platform for making dependencies (so it is recommended 
       to use Cygwin package with GCC in it).
     * For building documentation you need LaTex package. For the Windows platform 
       it is recommended to use GhostScript package version 6.5 or higher (paths to 
       its bin and lib should be in the environment variable PATH).
     * For building Java API driver your need Sun Microsystems JDK version 
       1.4 or higher.
     * The Sedna source code distribution for Windows contains some 
       libraries in the binary form. They are modified PCRE library, Chicken 
       Scheme compiler, Expat XML parser and PCCTS Tools. They are provided 
       in the binary form to simplify building process while they are still 
       available in the source code at the sites of their respective 
       developers. Actually, you need not know about them until you got 
       problems with them or you are going to port Sedna to other platforms.

   Note: We neither support nor plan to support MinGW environment for building
   Sedna on Windows. If you do not have Microsoft Visual C++ consider using
   free building tools from Microsoft: Microsoft Visual C++ Express
   together with Microsoft Windows Platform SDK.

   Also check that you have sufficient disk space. You will need about 100
   MB for the source tree during compilation and about 15 MB for the
   installation directory. The default size database requires 
   additionally about 400 Mb.
     _________________________________________________________________

                           Installation Procedure

    1. Configuration
       The first step of the installation procedure is to set environment
       variables for building Sedna.

export ACTIVE_CONFIGURATION=Release

       Turns on the release mode. Otherwise (ACTIVE_CONFIGURATION=Debug) 
       executables will contain debug information.

export ENABLE_TRIGGERS=1

       Turns on support for triggers. Set ENABLE_TRIGGERS to 0 if you would 
       like to turn support for triggers off.

export EL_DEBUG=0

       Throw out all debug printings. Set EL_DEBUG to 1 if you would like
       to get all printings.

export JAVA_DRIVER=1
       
       Compiles Java driver. Set JAVA_DRIVER to 0 if you do not want java 
       driver to be compiled.

export SQL_CONNECTION=1

       Adds support to SQL Connections. Set SQL_CONNECTION to 0 if you do 
       not want SQL Connection to be compiled.

export STATIC_SYS_LIBS=0

       Links Sedna executables with shared system libraries. Set 
       STATIC_SYS_LIBS to 1 if you want to link Sedna executables with
       static system libraries.

export SEDNA_INSTALL=<install-path>

       Identifies the directory where to install Sedna in case of
       "make install" (see below).

    2. Build
       To start the build, type
make
       (Remember to use GNU make) The build may take anywhere from 10
       minutes to half an hour depending on your hardware. The last three
       lines displayed should be
===================================================================
Make done
===================================================================

    3. Installing the Files

make install
       This will install files into the directory identified by 
       $SEDNA_INSTALL that was specified in step 1. Make sure that you have 
       appropriate permissions to write into that area. 

    4. Setting Operating System Environment

       The operating system user that is going to run Sedna must have 
       r-w-x permissions for the following Sedna directories:

$SEDNA_INSTALL/data
$SEDNA_INSTALL/cfg

       To grant the necessary permisions to the user on Linux/MacOS
       you can use the following command (suppose, <sedna-user> is the user 
       that is going to run Sedna):

chown <sedna-user> cfg data

   Uninstallation: To undo the installation just delete files installed 
   into $SEDNA_INSTALL/sedna.

   Cleaning: After the installation you can make room by removing the
   built files from the source tree with the command "make clean".

     _________________________________________________________________

                          Post-Installation Setup

Environment Variables

   You may want to add $SEDNA_INSTALL/sedna/bin to the environment variable 
   PATH. Note, that we recommend you to use absolute path. 

Database Files

   Database files will be placed by default into $SEDNA_INSTALL/sedna.
   You may want to set up the place where database files are stored by modifying
   $SEDNA_INSTALL/sedna/etc/sednaconf.xml.sample. 
   See Sedna Administration Guide for details on how to configure Sedna.

FreeBSD

   To run Sedna under FreeBSD you need to perform the following additional
   post-installation steps:
   
   1. Unfortunately FreeBSD has a bug [3] in System V semaphores. To run Sedna
      you have to recompile [1] your kernel with the following patch:

   
      ------------------------- sysv_sem.c -----------------------------
      *** 1145,1154 ****
      --- 1145,1159 ----
                              error = EIDRM;
                              goto done2;
                      }
            
                      /*
      +                * Renew the semaphore's pointer after wakeup
      +                */
      +               semptr = &semakptr->u.sem_base[sopptr->sem_num];
      +
      +               /*
                       * The semaphore is still alive.  Readjust the count of
                       * waiting processes.
                       */
                      if (sopptr->sem_op == 0)
                              semptr->semzcnt--;
      -------------------------------------------------------------------
   
   
   2. Increase system IPC configuration either using "sysctl" utility [2] 
      or through /boot/loader.conf. Below possible values are listed:

      kern.ipc.semmnu=256
      kern.ipc.semmns=512
      kern.ipc.semmni=256
      kern.ipc.semmap=256
   
   [1]. building BSD custom kernel:  http://www.freebsd.org/doc/en/books/handbook/kernelconfig-building.html;
   [2]. tuning with sysctl: http://www.freebsd.org/doc/en/books/handbook/configtuning-sysctl.html;
   [3]. problem report: http://www.freebsd.org/cgi/query-pr.cgi?pr=123731
     _________________________________________________________________

                              Getting Started

   Sedna is distributed with examples and instructions how to run it.
   See Sedna Quick Start available at "doc" subdirectory of the directory 
   where Sedna is installed.

     _________________________________________________________________

                                 What Now?

   * The Sedna distribution contains a documentation set, which should be
     useful. See documentation at "doc" subdirectory of the directory 
     where Sedna is installed.
   * For support, please, feel free to contact us with questions, 
     suggestions, bug reports and comments:

modis@ispras.ru

     For up-to-date information and new versions of Sedna visit the Sedna 
     homepage:

http://www.modis.ispras.ru/sedna

     You can also join the Sedna mail lists at

https://lists.sourceforge.net/lists/listinfo/sedna-discussion
